{% extends 'base.html' %}
{% block title %}Gérer les offres d'emplois{% endblock %}
{% block content %}
<div class="text-center mb-12">
    <h1 class="text-4xl font-bold text-primary-500">Gérer les offres d'emplois</h1>
</div>
<div class="section mx-auto max-w-3xl">
    <p class="text-neutral-600 mb-8">Ajoutez une nouvelle offre d’emploi, modifiez ou supprimez celles que vous ne voulez plus. Attention, la suppression est irréversible.</p>
    {% if messages %}
        {% for message in messages %}
            <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <!-- Formulaire pour ajouter une nouvelle offre -->
    <h2 class="text-2xl font-semibold text-primary-500 mb-4">Ajouter une nouvelle offre d'emploi</h2>
    <form method="post" enctype="multipart/form-data" class="space-y-4 mb-12">
        {% csrf_token %}
        <div>
            <label for="id_title" class="block text-sm font-medium text-neutral-600">Titre</label>
            {{ form.title }}
        </div>
        <div>
            <label for="id_description" class="block text-sm font-medium text-neutral-600">Description</label>
            {{ form.description }}
        </div>
        <div>
            <label for="id_email_contact" class="block text-sm font-medium text-neutral-600">Rentrez votre email personnel (utilisé à des fins de journalisation)</label>
            {{ form.email_contact }}
        </div>
        <div>
            <label for="id_document" class="block text-sm font-medium text-neutral-600">Document (optionnel, PDF, DOCX, TXT, etc.)</label>
            {{ form.document }}
        </div>
        <div class="text-center">
            <button type="submit" class="bg-secondary-500 text-white px-6 py-3 rounded-lg hover:bg-secondary-600 hover:scale-105 transition-all">Ajouter l’offre</button>
        </div>
    </form>

    <!-- Liste des offres existantes -->
    <h2 class="text-2xl font-semibold text-primary-500 mb-4">Offres existantes</h2>
    {% if job_offers %}
        <ul class="space-y-4">
            {% for job in job_offers %}
                <li class="bg-white shadow-lg rounded-lg p-4 flex justify-between items-center">
                    <div class="flex-1">
                        <strong class="text-primary-500">{{ job.title }}</strong> (Publié le : {{ job.posted_date }})<br>
                        <p class="text-neutral-600">{{ job.description|truncatewords:20 }}</p>
                        <p class="text-sm text-gray-500">Email : {{ job.email_contact }}</p>
                        {% if job.document %}
                            <p class="text-sm text-gray-500">Document : <a href="{{ job.document.url }}" class="text-primary-500 hover:underline" target="_blank">{{ job.document.name }}</a></p>
                        {% endif %}
                    </div>
                    <div class="flex space-x-2">
                        <a href="{% url 'modifier_offre_emploi' job.id %}" class="bg-primary-500 text-white px-4 py-2 rounded hover:bg-primary-600 transition-colors">Modifier</a>
                        <form method="post" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cette offre d’emploi ? Cette action est irréversible.');" class="inline">
                            {% csrf_token %}
                            <input type="hidden" name="job_id" value="{{ job.id }}">
                            <button type="submit" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">Supprimer</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-neutral-600 mb-4">Aucune offre d’emploi pour le moment. Ajoutez-en une ci-dessus.</p>
    {% endif %}

    <div class="text-center mt-8">
        <a href="{% url 'tableau_de_bord' %}" class="inline-block bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 hover:scale-105 transition-all">Retour au tableau de bord</a>
    </div>
</div>
{% endblock %}

