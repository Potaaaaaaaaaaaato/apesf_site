{% extends 'base.html' %}
{% load static %}
{% block title %}Accueil{% endblock %}
{% block content %}
<!-- Style personnalisé pour les carrousels -->
<style>
    /* Conteneurs des carrousels */
    .carousel-container, .news-carousel {
        position: relative;
        width: 100%;
    }

    /* Taille fixe pour les carrousels */
    .swiper {
        width: 100%;
        height: 400px; /* Taille fixe pour les deux carrousels */
        position: relative;
    }

    /* Style pour le carrousel d'images */
    #carouselAccueil .swiper-slide {
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #carouselAccueil .swiper-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover; /* S'assure que l'image remplit le conteneur sans déformation */
    }

    /* Style pour le carrousel d'actualités */
    .news-carousel .swiper-slide {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px 60px; /* Augmente le padding latéral pour laisser de l'espace aux flèches */
        background-color: #f9f9f9;
        border-radius: 8px;
        height: 100%;
        overflow: hidden; /* Empêche le contenu de dépasser */
    }
    .news-carousel .swiper-slide img {
        max-width: 100%;
        max-height: 150px;
        object-fit: cover;
        margin-bottom: 15px;
    }
    .news-carousel .swiper-slide h3 {
        font-size: 1.125rem; /* 18px */
        font-weight: 600;
        color: #1B4F72; /* Couleur primaire */
        margin-bottom: 8px;
    }
    .news-carousel .swiper-slide p {
        font-size: 0.875rem; /* 14px */
        color: #4B5563; /* Couleur neutre */
        margin-bottom: 8px;
        max-height: 80px; /* Limite la hauteur du texte */
        overflow: hidden;
        text-overflow: ellipsis; /* Ajoute "..." si le texte dépasse */
        display: -webkit-box;
        -webkit-line-clamp: 6; /* Limite à 4 lignes */
        -webkit-box-orient: vertical;
    }
    .news-carousel .swiper-slide a {
        font-size: 0.875rem; /* 14px */
        color: #1B4F72;
        text-decoration: underline;
    }

    /* Style pour les flèches de navigation */
    .swiper-button-prev, .swiper-button-next {
        width: 24px; /* Réduit la taille des flèches */
        height: 24px;
        background-size: 24px;
        color: #1B4F72;
        top: 50%;
        transform: translateY(-50%);
        margin-top: 0;
        z-index: 10; /* S'assure qu'elles sont au-dessus des autres éléments */
        background-color: rgba(255, 255, 255, 0.8); /* Fond blanc semi-transparent */
        border-radius: 50%; /* Rend les flèches rondes */
    }
    .swiper-button-prev {
        left: 15px; /* Position ajustée à l'intérieur, mais avec assez d'espace */
    }
    .swiper-button-next {
        right: 15px; /* Position ajustée à l'intérieur, mais avec assez d'espace */
    }
    .swiper-button-prev:after, .swiper-button-next:after {
        font-size: 16px; /* Réduit la taille de l'icône */
    }

    /* Style pour la pagination */
    .swiper-pagination {
        bottom: 10px !important; /* Positionne à l'intérieur du carrousel */
        z-index: 10;
    }
    .swiper-pagination-bullet {
        background: #1B4F72;
        opacity: 0.5;
    }
    .swiper-pagination-bullet-active {
        opacity: 1;
    }

    /* Style pour la barre d'icônes réseaux sociaux */
    .social-bar-container {
        position: relative;
        display: flex;
        align-items: center;
    }
    .social-bar {
        position: absolute;
        top: 50%;
        left: -80px; /* Déplace encore plus à gauche */
        transform: translateY(-50%);
        z-index: 10;
    }
    .social-bar a {
        display: block;
        margin: 10px 0;
        color: #000000 !important;
        font-size: 1.5rem;
        transition: color 0.3s ease;
    }
    .social-bar a:hover {
        color: #E84C3D !important;
    }
    @media (max-width: 768px) {
        .social-bar {
            display: none;
        }
        /* Ajustements pour les flèches sur mobile */
        .swiper-button-prev {
            left: 5px;
        }
        .swiper-button-next {
            right: 5px;
        }
        .swiper {
            height: 300px; /* Réduit la hauteur sur mobile */
        }
        .swiper-pagination {
            bottom: 5px !important;
        }
        .news-carousel .swiper-slide {
            padding: 20px 40px; /* Réduit le padding sur mobile */
        }
        .swiper-button-prev, .swiper-button-next {
            width: 20px; /* Taille encore plus petite sur mobile */
            height: 20px;
            background-size: 20px;
        }
        .swiper-button-prev:after, .swiper-button-next:after {
            font-size: 14px;
        }
    }
</style>

<!-- Hero Section -->
<section class="py-2 text-center">
    <div class="container mx-auto px-6">
        <h1 class="text-4xl md:text-5xl font-bold text-primary-500 mb-4">
            Association Pour l'Enfant et Sa Famille
        </h1>
        <p class="text-lg text-neutral-600 mb-8 max-w-2xl mx-auto">
            Depuis 1934, nous accompagnons les enfants et leurs familles à Saint-Étienne, en favorisant leur épanouissement et en protégeant leurs droits à travers nos maisons d’enfants, Les Marmousets et L’Angélus.
        </p>
    </div>
</section>

<!-- Section Carrousel et carrousel d'actualités -->
<section class="container mx-auto px-6 mb-12">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Conteneur pour la barre d'icônes et le carrousel -->
        <div class="social-bar-container">
            <!-- Barre d'icônes réseaux sociaux -->
            <div class="social-bar">
                <a href="mailto:contact@apesf.fr" title="Nous envoyer un email"><i class="bi bi-envelope"></i></a>
                <a href="https://facebook.com" target="_blank" title="Facebook"><i class="bi bi-facebook"></i></a>
                <a href="https://linkedin.com" target="_blank" title="LinkedIn"><i class="bi bi-linkedin"></i></a>
                <a href="https://instagram.com" target="_blank" title="Instagram"><i class="bi bi-instagram"></i></a>
            </div>
            
            <!-- Carrousel (Swiper) -->
            <div class="carousel-container">
                <div id="carouselAccueil" class="swiper">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide">
                            <img src="{% static 'images/carousel-image-1.jpg' %}" alt="Activités avec les enfants">
                        </div>
                        <div class="swiper-slide">
                            <img src="{% static 'images/carousel-image-2.jpg' %}" alt="Moments partagés en famille">
                        </div>
                        <div class="swiper-slide">
                            <img src="{% static 'images/carousel-image-3.jpg' %}" alt="Les Marmousets">
                        </div>
                        <div class="swiper-slide">
                            <img src="{% static 'images/carousel-image-4.jpg' %}" alt="L’Angélus">
                        </div>
                        <div class="swiper-slide">
                            <img src="{% static 'images/carousel-image-5.jpg' %}" alt="Soutien éducatif">
                        </div>
                    </div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </div>

        <!-- Carrousel d'actualités -->
        <div class="news-carousel">
            <div id="carouselNews" class="swiper">
                <div class="swiper-wrapper">
                    {% for news in news_items %}
                        <div class="swiper-slide">
                            {% if news.image %}
                                <img src="{{ news.image.url }}" alt="{{ news.title }}">
                            {% endif %}
                            <h3>{{ news.title }}</h3>
                            <p>{{ news.content }}</p>
                            <p>{{ news.date }}</p>
                            {% if news.document %}
                                <a href="{{ news.document.url }}" target="_blank">Télécharger la pièce jointe</a>
                            {% endif %}
                        </div>
                    {% empty %}
                        <div class="swiper-slide">
                            <p class="text-neutral-600">Aucune actualité disponible pour le moment.</p>
                        </div>
                    {% endfor %}
                </div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
    </div>
</section>

<!-- Texte de présentation -->
<section class="py-8 text-center">
    <div class="container mx-auto px-6">
        <p class="text-lg text-neutral-600 leading-loose max-w-3xl mx-auto">
            L’association Pour l’Enfant et sa Famille accompagne depuis des décennies les enfants et les familles en difficulté, à travers des dispositifs d’accueil souples et adaptés.
            Nos équipes engagées œuvrent chaque jour pour offrir un environnement sécurisé, bienveillant et respectueux du parcours de chacun.
            Une mission en constante évolution, portée par l’écoute, l’innovation et la solidarité.        </p>
    </div>
</section>

<section class="py-8 text-center">
    <div class="container mx-auto px-6">
        <a href="{% url 'qui_sommes_nous' %}" class="inline-block bg-secondary-500 text-white px-6 py-3 rounded-lg hover:bg-secondary-600 hover:scale-105 transition-all">
            Découvrez nos établissements & services !
        </a>
    </div>
</section>

<!-- Bouton de don
<section class="py-8 text-center">
    <div class="container mx-auto px-6">
        <a href="{% url 'dons' %}" class="inline-block bg-secondary-500 text-white px-6 py-3 rounded-lg hover:bg-secondary-600 hover:scale-105 transition-all">
            Soutenez notre mission
        </a>
    </div>
</section> -->

<!-- Section Actualités
<section class="py-8 text-center">
    <div class="container mx-auto px-6">
        <h2 class="text-2xl font-semibold text-primary-500 mb-4">
            Découvrez les actualités récentes des maisons d’enfants
        </h2>
        <p class="text-lg text-neutral-600 max-w-2xl mx-auto">
            Suivez les initiatives et événements de nos unités Marmousets et Angélus, comme les conseils des ados, les activités culturelles ou les rénovations de nos espaces à Saint-Étienne.
        </p>
    </div>
</section>-->

<!-- Sections dynamiques
{% if page %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-12">
        {% for section in page.sections.all %}
            <div class="bg-white shadow-lg rounded-lg p-6 transform hover:scale-105 transition-transform">
                <h2 class="text-2xl font-semibold text-primary-500 mb-4">{{ section.title }}</h2>
                <p class="text-neutral-600 mb-4">{{ section.content }}</p>
                {% if section.link %}
                    <a href="{{ section.link }}" class="inline-block bg-primary-500 text-white px-4 py-2 rounded hover:bg-primary-600 transition-colors">
                        En savoir plus
                    </a>
                {% endif %}
                {% for image in section.images.all %}
                    <img src="{{ image.image.url }}" alt="Image" class="mt-4 w-full rounded-lg max-h-32 max-w-32 mx-auto object-contain">
                {% endfor %}
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="text-center text-neutral-600 mt-12">
        <p>Contenu non défini. Veuillez ajouter du contenu via l'interface admin, par exemple :</p>
    </div>
{% endif %}-->

<!-- Script pour initialiser les carrousels -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialisation du carrousel d'images
        const carouselAccueil = new Swiper('#carouselAccueil', {
            loop: true,
            autoplay: {
                delay: 5000, // 5 secondes par slide
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
        });

        // Initialisation du carrousel d'actualités
        const carouselNews = new Swiper('#carouselNews', {
            loop: true,
            autoplay: {
                delay: 5000, // 5 secondes par slide
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
        });
    });
</script>
{% endblock %}

